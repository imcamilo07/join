-- ================= CONFIG =================
local MAX_SERVERS = 5

-- ================= SETUP =================
local player = game.Players.LocalPlayer
local petMenu = player.PlayerGui:WaitForChild("PetMenu")
local mainFrame = petMenu:WaitForChild("Frame")
local scrolling = mainFrame:WaitForChild("ScrollingFrame")

local ignorados = {}

-- ================= UTILS =================
local function parseValor(txt)
	if not txt then return nil end
	txt = txt:gsub("%s","")

	local num = tonumber(txt:match("[%d%.]+"))
	if not num then return nil end

	if txt:find("B") then
		return num * 1e9
	elseif txt:find("M") then
		return num * 1e6
	end
end

-- ================= GUI =================
local gui = Instance.new("ScreenGui")
gui.Name = "JOIN_HELPER_GUI"
gui.ResetOnSpawn = false
gui.Parent = player.PlayerGui

-- JOIN (NO SE MUEVE)
local joinBtnUI = Instance.new("TextButton")
joinBtnUI.Size = UDim2.new(0, 200, 0, 60)
joinBtnUI.Position = UDim2.new(1, -220, 0, 20)
joinBtnUI.BackgroundColor3 = Color3.fromRGB(0,170,0)
joinBtnUI.TextColor3 = Color3.new(1,1,1)
joinBtnUI.TextScaled = true
joinBtnUI.Font = Enum.Font.SourceSansBold
joinBtnUI.Visible = false
joinBtnUI.Parent = gui

-- BOTÃ“N DESPLEGABLE
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 200, 0, 28)
toggleBtn.Position = UDim2.new(1, -220, 0, -14)
toggleBtn.AnchorPoint = Vector2.new(0,1)
toggleBtn.Text = "IGNORADOS â–²"
toggleBtn.TextScaled = true
toggleBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
toggleBtn.TextColor3 = Color3.new(1,1,1)
toggleBtn.Parent = gui

-- LISTA (HACIA ARRIBA)
local listFrame = Instance.new("Frame")
listFrame.Size = UDim2.new(0, 200, 0, 120)
listFrame.Position = UDim2.new(1, -220, 0, -14)
listFrame.AnchorPoint = Vector2.new(0,1)
listFrame.BackgroundTransparency = 0.1
listFrame.Visible = false
listFrame.Parent = gui

local layout = Instance.new("UIListLayout")
layout.Padding = UDim.new(0, 4)
layout.Parent = listFrame

toggleBtn.MouseButton1Click:Connect(function()
	listFrame.Visible = not listFrame.Visible
	toggleBtn.Text = listFrame.Visible and "IGNORADOS â–¼" or "IGNORADOS â–²"
end)

local function limpiarLista()
	for _,c in ipairs(listFrame:GetChildren()) do
		if c:IsA("TextButton") then
			c:Destroy()
		end
	end
end

-- ================= CORE =================
local function escanear()
	limpiarLista()
	local lista = {}

	for _,obj in ipairs(scrolling:GetChildren()) do
		if obj:IsA("Frame") then
			local lbl = obj:FindFirstChildWhichIsA("TextLabel")
			if lbl then
				local valor = parseValor(lbl.Text)
				if valor then
					table.insert(lista, {
						frame = obj,
						valor = valor,
						texto = lbl.Text
					})
				end
			end
		end
	end

	if #lista == 0 then
		joinBtnUI.Visible = false
		return
	end

	-- botones ignorar
	for _,srv in ipairs(lista) do
		local b = Instance.new("TextButton")
		b.Size = UDim2.new(1,0,0,22)
		b.Text = srv.texto
		b.TextScaled = true
		b.BackgroundColor3 = Color3.fromRGB(70,70,70)
		b.TextColor3 = Color3.new(1,1,1)
		b.Parent = listFrame

		b.MouseButton1Click:Connect(function()
			ignorados[srv.valor] = true
			b.Text = srv.texto .. " (IGN)"
			print("[Auto] Ignorado:", srv.texto)
		end)
	end

	-- ORDENAR
	table.sort(lista, function(a,b)
		return a.valor > b.valor
	end)

	-- ðŸ”¥ BUSCAR EL MEJOR NO IGNORADO
	local elegido = nil
	for _,srv in ipairs(lista) do
		if not ignorados[srv.valor] then
			elegido = srv
			break
		end
	end

	if not elegido then
		print("[Auto] Todos los servidores ignorados")
		joinBtnUI.Visible = false
		return
	end

	joinBtnUI.Text = "JOIN " .. elegido.texto
	joinBtnUI.Visible = true

	for _,c in ipairs(getconnections(joinBtnUI.MouseButton1Click)) do
		c:Disable()
	end

	joinBtnUI.MouseButton1Click:Connect(function()
		joinBtnUI.Visible = false
		local inner = elegido.frame:FindFirstChildWhichIsA("Frame")
		if not inner then return end
		local realJoin = inner:FindFirstChildWhichIsA("TextButton")
		if not realJoin then return end
		for _,conn in ipairs(getconnections(realJoin.MouseButton1Click)) do
			conn:Fire()
		end
	end)
end

-- ================= TRIGGER =================
local lock = false
scrolling.ChildAdded:Connect(function()
	if lock then return end
	lock = true
	task.wait(0.3)
	escanear()
	lock = false
end)

print("[Auto] Script listo (lista arriba + mejor no ignorado).")








