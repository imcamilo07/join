-- ================= CONFIG =================
local MAX_SERVERS = 5

-- ================= SETUP =================
local player = game.Players.LocalPlayer
local petMenu = player.PlayerGui:WaitForChild("PetMenu")
local mainFrame = petMenu:WaitForChild("Frame")
local scrolling = mainFrame:WaitForChild("ScrollingFrame")

-- Ignorados MANUALES (no se tocan solos)
local ignorados = {}

-- ================= UTILS =================
local function parseValor(txt)
	if not txt then return nil end
	txt = txt:gsub("%s","")

	local num = tonumber(txt:match("[%d%.]+"))
	if not num then return nil end

	if txt:find("B") then
		return num * 1e9
	elseif txt:find("M") then
		return num * 1e6
	end
	return nil
end

-- ================= GUI =================
local gui = Instance.new("ScreenGui")
gui.Name = "JOIN_HELPER_GUI"
gui.ResetOnSpawn = false
gui.Parent = player.PlayerGui

-- JOIN BUTTON (NO SE TOCA FUNCIONALIDAD)
local bigBtn = Instance.new("TextButton")
bigBtn.Size = UDim2.new(0, 200, 0, 60)
bigBtn.Position = UDim2.new(1, -220, 0, 20)
bigBtn.BackgroundColor3 = Color3.fromRGB(0,170,0)
bigBtn.TextColor3 = Color3.new(1,1,1)
bigBtn.TextScaled = true
bigBtn.Font = Enum.Font.SourceSansBold
bigBtn.Visible = false
bigBtn.Parent = gui

-- ðŸ“‹ LISTA DE IGNORAR (ARRIBA DEL JOIN)
local listFrame = Instance.new("Frame")
listFrame.Size = UDim2.new(0, 200, 0, 140)
listFrame.Position = UDim2.new(1, -220, 0, 90)
listFrame.BackgroundTransparency = 1
listFrame.Parent = gui

local layout = Instance.new("UIListLayout")
layout.Padding = UDim.new(0, 6)
layout.Parent = listFrame

-- Limpia la lista visual
local function limpiarLista()
	for _,c in ipairs(listFrame:GetChildren()) do
		if c:IsA("TextButton") then
			c:Destroy()
		end
	end
end

-- ================= CORE =================
local function escanear()
	limpiarLista()

	local lista = {}
	local vistos = 0

	print("----- [Auto] Escaneando servidores -----")

	for _,obj in ipairs(scrolling:GetChildren()) do
		if obj:IsA("Frame") then
			local lbl = obj:FindFirstChildWhichIsA("TextLabel")
			if lbl then
				local valor = parseValor(lbl.Text)
				if valor then
					vistos += 1
					print("[Scan #" .. vistos .. "]", lbl.Text)

					if vistos <= MAX_SERVERS then
						table.insert(lista, {
							frame = obj,
							valor = valor,
							texto = lbl.Text
						})
					end
				end
			end
		end
		if vistos >= MAX_SERVERS then break end
	end

	if #lista == 0 then
		bigBtn.Visible = false
		return
	end

	-- Crear BOTONES DE IGNORAR
	for _,srv in ipairs(lista) do
		local btn = Instance.new("TextButton")
		btn.Size = UDim2.new(1, 0, 0, 24)
		btn.BackgroundColor3 = Color3.fromRGB(60,60,60)
		btn.TextColor3 = Color3.new(1,1,1)
		btn.TextScaled = true
		btn.Font = Enum.Font.SourceSans
		btn.Text = srv.texto
		btn.Parent = listFrame

		btn.MouseButton1Click:Connect(function()
			ignorados[srv.valor] = true
			btn.Text = srv.texto .. " (IGNORADO)"
			btn.BackgroundColor3 = Color3.fromRGB(120,60,60)
			print("[Auto] Servidor ignorado:", srv.texto)
		end)
	end

	table.sort(lista, function(a,b)
		return a.valor > b.valor
	end)

	local mejor = lista[1]

	if ignorados[mejor.valor] then
		print("[Auto] Mejor servidor estÃ¡ ignorado:", mejor.texto)
		bigBtn.Visible = false
		return
	end

	print("[Auto] Mejor servidor:", mejor.texto)

	bigBtn.Text = "JOIN " .. mejor.texto
	bigBtn.Visible = true

	for _,c in ipairs(getconnections(bigBtn.MouseButton1Click)) do
		c:Disable()
	end

	bigBtn.MouseButton1Click:Connect(function()
		bigBtn.Visible = false

		local inner = mejor.frame:FindFirstChildWhichIsA("Frame")
		if not inner then return end

		local joinBtn = inner:FindFirstChildWhichIsA("TextButton")
		if not joinBtn then return end

		for _,conn in ipairs(getconnections(joinBtn.MouseButton1Click)) do
			conn:Fire()
		end
	end)
end

-- ================= TRIGGER =================
local escaneando = false
scrolling.ChildAdded:Connect(function()
	if escaneando then return end
	escaneando = true

	task.wait(0.4)
	escanear()

	escaneando = false
end)

print("[Auto] Script listo con lista de ignorar.")







